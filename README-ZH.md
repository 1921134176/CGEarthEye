<div align="center">

# <img width="60" alt="image" src="assets/gaofen.png"> CGEarthEye: å‰æ—ä¸€å·å¤§æ¨¡å‹æ„å»ºä¸åº”ç”¨

<div align="center">
  <img width="300" alt="image" src="assets/logo.png">
  <br>
</div>

[\[ğŸš€ Quick Start\]](https://www.jl1mall.com/) [\[ğŸ“– Report\]](./report) [\[ğŸ“¹ Weight\]](https://pan.baidu.com/s/12bds0ZTMwyRVgv7Nkq51Aw?pwd=cgwx)

![CGEarthEye](assets/model.png)

</div>

## Update ğŸš€ğŸš€ğŸš€

- 2025.05.30-CGEarthEyeå‘å¸ƒå‰æ—ä¸€å·äºšç±³çº§å…‰å­¦é¥æ„Ÿå½±åƒé¢„è®­ç»ƒæƒé‡ã€‚

## ä»‹ç»

ä¸ºæå‡å‰æ—ä¸€å·é¥æ„Ÿå«æ˜Ÿå½±åƒåº”ç”¨çš„æ™ºèƒ½åŒ–æ°´å¹³ï¼Œè§£ å†³è§†è§‰å¤§æ¨¡å‹åœ¨é«˜åˆ†è¾¨ç‡å«æ˜Ÿé¥æ„Ÿå½±åƒä¸Šæ€§èƒ½å—é™é—®é¢˜ï¼Œæˆ‘ä»¬æ„å»ºäº†åŒ…å«21äº¿å‚æ•°é‡çš„å‰æ—ä¸€å·é¥æ„Ÿå¤§æ¨¡å‹â€”â€”CGEarthEyeã€‚CGEarthEyeç»“åˆäº†ç”Ÿæˆå¼ä¸å¯¹æ¯”å¼è‡ªç›‘ç£å­¦ä¹ ç®—æ³•çš„ä¼˜åŠ¿ï¼Œå…·å¤‡å¯¹é¥æ„Ÿå½±åƒå…¨å±€ä¸å±€éƒ¨å»ºæ¨¡èƒ½åŠ›ï¼Œå¹¶åˆ©ç”¨äº†å…¨çƒåˆ†å¸ƒçš„1500ä¸‡é«˜è´¨é‡äºšç±³çº§å‰æ—ä¸€å·å«æ˜Ÿé¥æ„Ÿå½±åƒæ ·æœ¬ï¼Œåœ¨16å¼ A800 GPUä¸Šè¿›è¡Œäº†è®­ç»ƒã€‚å¯¹æ¯”è§†è§‰é¢†åŸŸå¤§æ¨¡å‹ï¼ŒCGEarthEyeä»…ä»…å¾®è°ƒè§£ç å™¨çš„æƒ…å†µä¸‹ï¼Œå„é¡¹é¥æ„Ÿä»»åŠ¡æ˜¾è‘—ä¼˜äºå…¨é‡å¾®è°ƒçš„è§†è§‰é¢†åŸŸå¤§æ¨¡å‹ã€‚å¯¹æ¯”é¥æ„Ÿé¢†åŸŸå¤§æ¨¡å‹ï¼ŒCGEarthEyeå…·å¤‡å¤§å¤šæ•°é¥æ„Ÿé¢†åŸŸå¤§æ¨¡å‹ä¸å…·å¤‡çš„å†»ç»“å¾®è°ƒèƒ½åŠ›ï¼Œæå¤§ç¼©çŸ­åº”ç”¨å¾®è°ƒæ—¶é—´ä¸æ˜¾å­˜ï¼Œç¼“è§£äº†å¤§æ¨¡å‹ä¸‹æ¸¸å¾®è°ƒå›°éš¾é—®é¢˜ï¼Œå¹¶åœ¨4é¡¹ä»»åŠ¡10ä¸ªæ•°æ®é›†ä¸Šå®ç°å†»ç»“æ€§èƒ½SOTAã€‚

## éª¨å¹²

[Baidu](https://pan.baidu.com/s/12bds0ZTMwyRVgv7Nkq51Aw?pwd=cgwx)

|       æ¨¡å‹       | å±‚æ•° | ç¼–ç ç»´åº¦ | éšè—å±‚ç»´åº¦ | æ³¨æ„åŠ›å¤´ | å‚æ•°é‡/M |
| :--------------: | :--: | :------: | :--------: | :------: | :------: |
| CGEarthEye-Small |  12  |   384    |    1536    |    6     |    22    |
| CGEarthEye-Base  |  12  |   768    |    3072    |    12    |    86    |
| CGEarthEye-Large |  24  |   1024   |    4096    |    16    |   307    |
| CGEarthEye-Huge  |  32  |   1280   |    5120    |    16    |   632    |
| CGEarthEye-Giant |  40  |   1536   |    6144    |    24    |   1100   |

## æµ‹è¯•

![experiments](assets/experiments.png)

## åº”ç”¨

åœ¨åº”ç”¨æ–¹é¢ï¼ŒåŸºäºCGEarthEyeï¼Œæˆ‘ä»¬å¾®è°ƒäº†20ç§åº”ç”¨æ¨¡å‹ï¼Œå·²ä¸Šçº¿å‰æ—ä¸€å·ç½‘[https://www.jl1mall.com/](å‰æ—ä¸€å·ç½‘)ã€‚

<div align="center">
  <img width="500" alt="image" src="assets/application.png">
  <br>
</div>

## å¾®è°ƒ

æœ€åï¼Œæˆ‘ä»¬ä¸ºå‰æ—ä¸€å·æ•°æ®é›†ç¼–å†™äº†è®­ç»ƒé…ç½®ï¼Œç”¨æˆ·å¯æ ¹æ®ä¸šåŠ¡å¿«é€Ÿåˆ©ç”¨CGEarthEyeå®Œæˆåº”ç”¨çš„è¿­ä»£ã€‚

### ç¯å¢ƒ


```bash
conda create -n CGEarthEye python=3.10
conda activate CGEarthEye
pip install -r requirements.txt
```
### æ•°æ®å‡†å¤‡

#### åœºæ™¯åˆ†ç±»

- [AID](captain-whu.github.io/AID/)
- [NWPU_RESISC45](https://gcheng-nwpu.github.io/#Datasets)

```bash
|-datasets/SceneClassification
|----AID
|    |---Airport
|        |---airport_1.jpg
|        |---airport_2.jpg
|        |---    Â·Â·Â·
|    |---BareLand
|        |---bareland_1.jpg
|        |---    Â·Â·Â·
|    |---  Â·Â·Â·
|    |---train_80per.txt
|    |---val_20per.txt
|----NWPU_RESISC45
|    |---airplane
|        |---airplane_001.jpg
|        |---    Â·Â·Â·
|    |---airport
|        |---airport_0011.jpg
|        |---    Â·Â·Â·
|    |---  Â·Â·Â·
|    |---train_80per.txt
|    |---val_20per.txt
...
```

#### è¯­ä¹‰åˆ†å‰²

- [ISAID](https://captain-whu.github.io/iSAID/index.html)
- [cropland](http://10.200.30.48:8080/store)

```bash
|-datasets/SemanticSegmentation
|----cropland
|    |---train
|        |---Img
|            |---LC_01_000001.png
|            |---LC_01_000002.png
|            |---    Â·Â·Â·
|        |---Label
|            |---LC_01_000001.png
|            |---LC_01_000002.png
|            |---    Â·Â·Â·
|    |---val
|        |---Img
|            |---LC_01_000001.png
|            |---LC_01_000002.png
|            |---    Â·Â·Â·
|        |---Label
|            |---LC_01_000001.png
|            |---LC_01_000002.png
|            |---    Â·Â·Â·
|    |---test
|        |---Img
|            |---LC_01_000001.png
|            |---LC_01_000002.png
|            |---    Â·Â·Â·
|        |---Label
|            |---LC_01_000001.png
|            |---LC_01_000002.png
|            |---    Â·Â·Â·

|----ISAID
|    |---img_dir
|        |---train
|            |---P0003_0_896_0_896.png
|            |---    Â·Â·Â·
|        |---val
|            |---P0003_0_896_0_896.png
|            |---    Â·Â·Â·
|        |---test
|            |---P0003_0_896_0_896.png
|            |---    Â·Â·Â·
|    |---ann_dir
|        |---train
|            |---P0003_0_896_0_896_instance_color_RGB.png
|            |---    Â·Â·Â·
|        |---val
|            |---P0003_0_896_0_896_instance_color_RGB.png
|            |---    Â·Â·Â·
|        |---test
|            |---P0003_0_896_0_896_instance_color_RGB.png
|            |---    Â·Â·Â·
...
```

#### å˜åŒ–æ£€æµ‹
- [LEVIR-CD](https://opendatalab.com/OpenDataLab/LEVIR-CD)
- [SYSU-CD](https://github.com/liumency/SYSU-CD)
- [CDD](https://paperswithcode.com/dataset/cdd-dataset-season-varying)
```bash
|-datasets/ChangeDetection
|----SYSU-CD
|    |---train
|        |---Image1
|           |---00000.png
|           |---    Â·Â·Â·
|        |---Image2
|           |---00000.png
|           |---    Â·Â·Â·
|        |---Label
|           |---00000.png
|           |---    Â·Â·Â·
|    |---val
|        |---Image1
|           |---00000.png
|           |---    Â·Â·Â·
|        |---Image2
|           |---00000.png
|           |---    Â·Â·Â·
|        |---Label
|           |---00000.png
|           |---    Â·Â·Â·
|    |---test
|        |---Image1
|           |---00000.png
|           |---    Â·Â·Â·
|        |---Image2
|           |---00000.png
|           |---    Â·Â·Â·
|        |---Label
|           |---00000.png
|           |---    Â·Â·Â·
|----LEVIR-CD
|...
|----CDD
|...
```
#### ç›®æ ‡æ£€æµ‹
- [DIOR / DIOR-R](www.escience.cn/people/JunweiHan/DIOR.html)


```bash
|-datasets/ObjectDetection
|----DIOR
|    |---images
|        |---trainval/
|        |    |---00001.jpg
|        |    |---00002.jpg
|        |    |---  ...
|        |---test/
|        |    |---11726.jpg
|        |    |---11727.jpg
|        |    |---  ...
|    |---Annotations
|        |---trainval.json
|        |---test.json

|----DIOR-R
|    |---images
|        |---trainval/
|        |    |---00001.jpg
|        |    |---00002.jpg
|        |    |---  ...
|        |---test/
|        |    |---11726.jpg
|        |    |---11727.jpg
|        |    |---  ...
|    |---ImageSets
|        |---Main
|        |    |---train.txt
|        |    |---val.txt
|        |    |---test.txt
|    |---Annotations
|        |---Oriented Bounding Boxes
|        |    |---00001.xml
|        |    |---00002.xml
|        |    |---  ....
```


### æ¨¡å‹è®­ç»ƒ

#### åœºæ™¯åˆ†ç±»

```bash
# å•æœºå•å¡
python tools/train_sc.py \
    config/SceneClassification/CGEarthEye-Giant-518-AID.py \
    --amp
```
```bash
# å•æœºå¤šå¡
python tools/dist_train_sc.sh \
    config/SceneClassification/CGEarthEye-Giant-518-AID.py
```
#### è¯­ä¹‰åˆ†å‰²

```bash
# å•æœºå•å¡
python ./tools/train_ss.py config/SemanticSegmentation/CGEarthEye-Giant-518-ISAID
```
```bash
# å•æœºå¤šå¡
bash ./tools/dist_train_ss.sh config/SemanticSegmentation/CGEarthEye-Giant-518-ISAID 4
```
#### å˜åŒ–æ£€æµ‹

```bash
# å•æœºå•å¡
python ./tools/train_cd.py config/ChangeDetection/CGEarthEye-Giant-518-levircd.py
```
```bash
# å•æœºå¤šå¡
bash ./tools/dist_train_cd.sh config/ChangeDetection/CGEarthEye-Giant-518-levircd.py 4
```
#### ç›®æ ‡æ£€æµ‹

```bash
# æ°´å¹³æ¡†æ£€æµ‹ï¼ˆMMDetection3.xï¼‰
## å•æœºå•å¡
python tools/train_hbb.py config/ObjectDetection/HBB/CGEarthEye-Giant-784-DIOR.py
## å•æœºå¤šå¡
CUDA_VISIBLE_DEVICES=0,1,2,3 bash tools/dist_train_hbb.sh config/ObjectDetection/HBB/CGEarthEye-Giant-784-DIOR.py 4
```

```bash
# æ—‹è½¬æ¡†æ£€æµ‹ï¼ˆMMRotate1.xï¼‰
## å•æœºå•å¡
python tools/train_obb.py config/ObjectDetection/OBB/CGEarthEye-Giant-784-DIORR.py
## å•æœºå¤šå¡
CUDA_VISIBLE_DEVICES=0,1,2,3 bash tools/dist_train_obb.sh config/ObjectDetection/OBB/CGEarthEye-Giant-784-DIORR.py 4
```

### æ¨¡å‹æµ‹è¯•

#### åœºæ™¯åˆ†ç±»

```bash
# å•æœºå•å¡
python tools/test_sc.py \
    config/SceneClassification/CGEarthEye-Giant-518-AID.py
```
```bash
# å•æœºå¤šå¡
python tools/dist_test_sc.sh \
    config/SceneClassification/CGEarthEye-Giant-518-AID.py
```

#### è¯­ä¹‰åˆ†å‰²
```bash
# å•æœºå•å¡
python tools/test_ss.py \
    config/SemanticSegmentation/CGEarthEye-Giant-518-ISAID.py
```
```bash
# å•æœºå¤šå¡
python tools/dist_test_ss.sh \
    config/SemanticSegmentation/CGEarthEye-Giant-518-ISAID.py
```

#### å˜åŒ–æ£€æµ‹
```bash
# å•æœºå•å¡
python ./tools/test_cd.py config/ChangeDetection/CGEarthEye-Giant-518-levircd.py work_dir/last.pth
```
#### ç›®æ ‡æ£€æµ‹

```bash
# æ°´å¹³æ¡†æ£€æµ‹ï¼ˆMMDetection3.xï¼‰
## å•æœºå•å¡
python tools/test_hbb.py \
    config/ObjectDetection/HBB/CGEarthEye-Giant-784-DIOR.py \
    Path/To/Your/Weight/hbb_model.pth
## å•æœºå¤šå¡
CUDA_VISIBLE_DEVICES=0,1,2,3 bash tools/dist_test_hbb.sh \
    config/ObjectDetection/HBB/CGEarthEye-Giant-784-DIOR.py \
    Path/To/Your/Weight/hbb_model.pth 4
```

```bash
# æ—‹è½¬æ¡†æ£€æµ‹ï¼ˆMMRotate1.xï¼‰
## å•æœºå•å¡
python tools/test_obb.py \
    config/ObjectDetection/OBB/CGEarthEye-Giant-784-DIORR.py \
    Path/To/Your/Weight/obb_model.pth
## å•æœºå¤šå¡
CUDA_VISIBLE_DEVICES=0,1,2,3 bash tools/dist_test_obb.sh \
    config/ObjectDetection/OBB/CGEarthEye-Giant-784-DIORR.py \
    Path/To/Your/Weight/obb_model.pth 4
```

## License

This project is released under the [MIT license](LICENSE). Parts of this project contain code and models from other sources, which are subject to their respective licenses.

## ğŸ’¡ Relevant Projects

[1] <strong>Skysense: A multi-modal remote sensing foundation model towards universal interpretation for earth observation imagery, IEEE CVPR, 2024</strong> | [Paper](https://arxiv.org/abs/2312.10115) 
<br><em>&ensp; &ensp; &ensp;Xin Guo<sup>&#8727;</sup>, Jiangwei Lao<sup>&#8727;</sup>, Bo Dang, Yingying Zhang, Lei Yu,Lixiang Ru,Liheng Zhong,Ziyuan Huang,Kang Wu,Dingxiang Hu,Huimei He,Jian Wang,Jingdong Chen,Ming Yang,Yongjun Zhang and Yansheng Li</em>

[2] <strong>Mtp: Advancing remote sensing foundation model via multi-task pretraining, IEEE JSTARS, 2024</strong> | [Paper](https://arxiv.org/abs/2403.13430/) | [Github](https://github.com/ViTAE-Transformer/MTP)
<br><em>&ensp; &ensp; &ensp;Di Wang<sup>&#8727;</sup>, Jing Zhang<sup>&#8727;</sup>, Minqiang Xu<sup>&#8727;</sup>, Lin Liu, Dongsheng Wang, Erzhong Gao,Chengxi Han,Haonan Guo and Bo Du</em>

[3] <strong>DINOv2: Learning Robust Visual Features without Supervision,2024</strong> | [Paper](arxiv.org/abs/2304.07193) | [Github](github.com/facebookresearch/dinov2)
<br><em>&ensp; &ensp; &ensp;Maxime Oquab<sup>&#8727;</sup>, TimothÃ©e Darcet, ThÃ©o Moutakanni, Huy Vo, Marc Szafraniec, Vasil Khalidov, Pierre Fernandez, Daniel Haziza, Francisco Massa, Alaaeldin El-Nouby, Mahmoud Assran, Nicolas Ballas, Wojciech Galuba, Russell Howes, Po-Yao Huang, Shang-Wen Li, Ishan Misra, Michael Rabbat, Vasu Sharma, Gabriel Synnaeve, Hu Xu, HervÃ© Jegou, Julien Mairal, Patrick Labatut, Armand Joulin and Piotr Bojanowski</em>
