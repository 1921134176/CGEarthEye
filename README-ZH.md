<div align="center">

# <img width="60" alt="image" src="assets/gaofen.png"> CGEarthEye: å‰æ—ä¸€å·å¤§æ¨¡å‹æ„å»ºä¸åº”ç”¨

<div align="center">
  <img width="300" alt="image" src="assets/logo.png">
  <br>
</div>

[\[ğŸš€ Quick Start\]](https://www.jl1mall.com/) [\[ğŸ“– Report\]](./report) [\[ğŸ“¹ Weight\]](https://pan.baidu.com/s/12bds0ZTMwyRVgv7Nkq51Aw?pwd=cgwx)

![CGEarthEye](assets/model.png)

## Update ğŸš€ğŸš€ğŸš€

- 2025.05.30-CGEarthEyeå‘å¸ƒå‰æ—ä¸€å·äºšç±³çº§å…‰å­¦é¥æ„Ÿå½±åƒé¢„è®­ç»ƒæƒé‡ã€‚

## ä»‹ç»

ä¸ºæå‡å‰æ—ä¸€å·é¥æ„Ÿå«æ˜Ÿå½±åƒåº”ç”¨çš„æ™ºèƒ½åŒ–æ°´å¹³ï¼Œè§£å†³è§†è§‰å¤§æ¨¡å‹åœ¨é«˜åˆ†è¾¨ç‡å«æ˜Ÿé¥æ„Ÿå½±åƒä¸Šæ€§èƒ½å—é™é—®é¢˜ï¼Œæˆ‘ä»¬æ„å»ºäº†åŒ…å«21äº¿å‚æ•°é‡çš„å‰æ—ä¸€å·é¥æ„Ÿå¤§æ¨¡å‹â€”â€”CGEarthEyeã€‚CGEarthEyeç»“åˆäº†ç”Ÿæˆå¼ä¸å¯¹æ¯”å¼è‡ªç›‘ç£å­¦ä¹ ç®—æ³•çš„ä¼˜åŠ¿ï¼Œå…·å¤‡å¯¹é¥æ„Ÿå½±åƒå…¨å±€ä¸å±€éƒ¨å»ºæ¨¡èƒ½åŠ›ï¼Œå¹¶åˆ©ç”¨äº†å…¨çƒåˆ†å¸ƒçš„1500ä¸‡é«˜è´¨é‡äºšç±³çº§å‰æ—ä¸€å·å«æ˜Ÿé¥æ„Ÿå½±åƒæ ·æœ¬ï¼Œåœ¨16å¼ A800 GPUä¸Šè¿›è¡Œäº†è®­ç»ƒã€‚å¯¹æ¯”è§†è§‰é¢†åŸŸå¤§æ¨¡å‹ï¼ŒCGEarthEyeä»…ä»…å¾®è°ƒè§£ç å™¨çš„æƒ…å†µä¸‹ï¼Œå„é¡¹é¥æ„Ÿä»»åŠ¡æ˜¾è‘—ä¼˜äºå…¨é‡å¾®è°ƒçš„è§†è§‰é¢†åŸŸå¤§æ¨¡å‹ã€‚å¯¹æ¯”é¥æ„Ÿé¢†åŸŸå¤§æ¨¡å‹ï¼ŒCGEarthEyeå…·å¤‡å¤§å¤šæ•°é¥æ„Ÿé¢†åŸŸå¤§æ¨¡å‹ä¸å…·å¤‡çš„å†»ç»“å¾®è°ƒèƒ½åŠ›ï¼Œæå¤§ç¼©çŸ­åº”ç”¨å¾®è°ƒæ—¶é—´ä¸æ˜¾å­˜ï¼Œç¼“è§£äº†å¤§æ¨¡å‹ä¸‹æ¸¸å¾®è°ƒå›°éš¾é—®é¢˜ï¼Œå¹¶åœ¨4é¡¹ä»»åŠ¡10ä¸ªæ•°æ®é›†ä¸Šå®ç°å†»ç»“æ€§èƒ½SOTAã€‚

## [éª¨å¹²](https://pan.baidu.com/s/12bds0ZTMwyRVgv7Nkq51Aw?pwd=cgwx)

|       æ¨¡å‹       | å±‚æ•° | ç¼–ç ç»´åº¦ | éšè—å±‚ç»´åº¦ | æ³¨æ„åŠ›å¤´ | å‚æ•°é‡/M |
| :--------------: | :--: | :------: | :--------: | :------: | :------: |
| CGEarthEye-Small |  12  |   384    |    1536    |    6     |    22    |
| CGEarthEye-Base  |  12  |   768    |    3072    |    12    |    86    |
| CGEarthEye-Large |  24  |   1024   |    4096    |    16    |   307    |
| CGEarthEye-Huge  |  32  |   1280   |    5120    |    16    |   632    |
| CGEarthEye-Giant |  40  |   1536   |    6144    |    24    |   1100   |

## æµ‹è¯•

![experiments](assets/experiments.png)

## åº”ç”¨

åœ¨åº”ç”¨æ–¹é¢ï¼ŒåŸºäºCGEarthEyeï¼Œæˆ‘ä»¬å¾®è°ƒäº†20ç§åº”ç”¨æ¨¡å‹ï¼Œå·²ä¸Šçº¿å‰æ—ä¸€å·ç½‘[https://www.jl1mall.com/](å‰æ—ä¸€å·ç½‘)ã€‚

<div align="center">
  <img width="500" alt="image" src="assets/application.png">
  <br>
</div>

## å¾®è°ƒ

æœ€åï¼Œæˆ‘ä»¬ä¸ºå‰æ—ä¸€å·æ•°æ®é›†ç¼–å†™äº†è®­ç»ƒé…ç½®ï¼Œç”¨æˆ·å¯æ ¹æ®ä¸šåŠ¡å¿«é€Ÿåˆ©ç”¨CGEarthEyeå®Œæˆåº”ç”¨çš„è¿­ä»£ã€‚

### ç¯å¢ƒ


```bash
conda create -n CGEarthEye python=3.10
conda activate CGEarthEye
pip install -r requirements.txt
```
### æ•°æ®å‡†å¤‡

#### åœºæ™¯åˆ†ç±»

- [AID](captain-whu.github.io/AID/)
- [NWPU_RESISC45](https://gcheng-nwpu.github.io/#Datasets)

```bash
|-datasets/SceneClassification
|----AID
|    |---Airport
|        |---airport_1.jpg
|        |---airport_2.jpg
|        |---    Â·Â·Â·
|    |---BareLand
|        |---bareland_1.jpg
|        |---    Â·Â·Â·
|    |---  Â·Â·Â·
|    |---train_80per.txt
|    |---val_20per.txt
|----NWPU_RESISC45
|    |---airplane
|        |---airplane_001.jpg
|        |---    Â·Â·Â·
|    |---airport
|        |---airport_0011.jpg
|        |---    Â·Â·Â·
|    |---  Â·Â·Â·
|    |---train_80per.txt
|    |---val_20per.txt
...
```

#### è¯­ä¹‰åˆ†å‰²

#### å˜åŒ–æ£€æµ‹

#### ç›®æ ‡æ£€æµ‹

### æ¨¡å‹è®­ç»ƒ

#### åœºæ™¯åˆ†ç±»

```bash
# å•æœºå•å¡
python tools/train_sc.py \
    config/SceneClassification/CGEarthEye-Giant-518-AID.py \
    --amp
```
```bash
# å•æœºå¤šå¡
python tools/dist_train_sc.sh \
    config/SceneClassification/CGEarthEye-Giant-518-AID.py
```
#### è¯­ä¹‰åˆ†å‰²

```bash
# å•æœºå•å¡
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/IMG_CT/[IMG_CT]_016_DIOR_25156_13931_ori.png \
    --post_process_type IMG_CT \
    --prompt "Count the number of ship."
```
```bash
# å•æœºå¤šå¡
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/IMG_CAP/[IMG_CAP]_010_RSICD_208_church_56_ori.png \
    --post_process_type IMG_CAP \
    --prompt "Describe the image."
```
#### å˜åŒ–æ£€æµ‹

```bash
# Inference for Detailed Image Caption task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/IMG_CAP_DETAILED/[IMG_CAP_DETAILED]_026_RSICD_126_commercial_5_ori.png \
    --post_process_type IMG_CAP_DETAILED \
    --prompt "Describe the image in detail."
```
```bash
# Inference for Region Classification-HBB task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/REG_CLS_HBB/[REG_CLS_HBB]_005_DIOR_3829_12264_ori.png \
    --post_process_type REG_CLS_HBB \
    --prompt "Classify the region of <box><855><297><891><355></box>.\nUse one or a few words."
```
#### ç›®æ ‡æ£€æµ‹

```bash
# Inference for Region Classification-OBB task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/REG_CLS_OBB/[REG_CLS_OBB]_001_DIOR_1_11726_ori.png \
    --post_process_type REG_CLS_OBB \
    --prompt "Classify the region of <quad><703><420><703><292><571><292><571><420></quad>.\nUse one or a few words."
```
```bash
# Inference for Region Detection-HBB task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/REG_DET_HBB/[REG_DET_HBB]_004_DIOR_5212_12735_ori.png \
    --post_process_type REG_DET_HBB \
    --prompt "Detect all stadium in the image."
```

### æ¨¡å‹æµ‹è¯•

#### åœºæ™¯åˆ†ç±»

```bash
# å•æœºå•å¡
python tools/test_sc.py \
    config/SceneClassification/CGEarthEye-Giant-518-AID.py
```
```bash
# å•æœºå¤šå¡
python tools/dist_test_sc.sh \
    config/SceneClassification/CGEarthEye-Giant-518-AID.py
```

#### è¯­ä¹‰åˆ†å‰²

#### å˜åŒ–æ£€æµ‹

#### ç›®æ ‡æ£€æµ‹

```bash
# Inference for Region Detection-OBB task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/REG_DET_OBB/[REG_DET_OBB]_034_DOTA2.0_77716_P0799_ori.png \
    --post_process_type REG_DET_OBB \
    --prompt "Detect all harbor in the image.\nUse oriented bounding boxes."
```
```bash
# Inference for Visual Grounding task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/REG_VG/[REG_VG]_002_DIOR-RSVG_69_00258_ori.png \
    --post_process_type REG_VG \
    --prompt "Detect an area that matches the description.\nfind a swimming pool that is about 118 square meters. there is a parking lot that is about 2988 square meters, located approximately 38 meters northeast of the swimming pool.\nUse horizontal bounding boxes."
```
```bash
# Inference for Region Caption task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/REG_CAP/[REG_CAP]_001_DIOR-RSVG_1_00006_ori.png \
    --post_process_type REG_CAP \
    --prompt "Describe the <box><622><706><696><831></box> in this image."
```
```bash
# Inference for Pixel Classification task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/PIX_CLS/[PIX_CLS]_039_GEONRW_74671_427_5725_rgb_ori.png \
    --post_process_type PIX_CLS \
    --prompt "Classify the region of <poly><1000><0><488><0><465><221><443><279><696><258><704><373><772><343><809><397><631><489><741><704><1000><682><1000><585><965><589><959><509><961><471><1000><413></poly>.\nUse one or a few words."
```
```bash
# Inference for Segmentation task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/PIX_SEG/[PIX_SEG]_034_GEONRW_376_5755_rgb-ori.png \
    --post_process_type PIX_SEG \
    --prompt "Segment out road in the image."
```
```bash
# Inference for Change Detection task
python inference.py \
    --checkpoint_path <path_to_the_checkpoint_you_want> \
    --image_path image_samples/PIX_CHG/[PIX_CHG]_199_WHU-CD_28911_590_ori.png \
    --image2_path image_samples/PIX_CHG/[PIX_CHG]_199_WHU-CD_28911_590_post.png \
    --post_process_type PIX_CHG \
    --prompt "Find changes in the two images."
```

## License

This project is released under the [MIT license](LICENSE). Parts of this project contain code and models from other sources, which are subject to their respective licenses.

## ğŸ’¡ Relevant Projects

[1] <strong>Skysense: A multi-modal remote sensing foundation model towards universal interpretation for earth observation imagery, IEEE CVPR, 2024</strong> | [Paper](https://arxiv.org/abs/2312.10115) 
<br><em>&ensp; &ensp; &ensp;Xin Guo<sup>&#8727;</sup>, Jiangwei Lao<sup>&#8727;</sup>, Bo Dang, Yingying Zhang, Lei Yu,Lixiang Ru,Liheng Zhong,Ziyuan Huang,Kang Wu,Dingxiang Hu,Huimei He,Jian Wang,Jingdong Chen,Ming Yang,Yongjun Zhang and Yansheng Li</em>

[2] <strong>Mtp: Advancing remote sensing foundation model via multi-task pretraining, IEEE JSTARS, 2024</strong> | [Paper](https://arxiv.org/abs/2403.13430/) | [Github](https://github.com/ViTAE-Transformer/MTP)
<br><em>&ensp; &ensp; &ensp;Di Wang<sup>&#8727;</sup>, Jing Zhang<sup>&#8727;</sup>, Minqiang Xu<sup>&#8727;</sup>, Lin Liu, Dongsheng Wang, Erzhong Gao,Chengxi Han,Haonan Guo and Bo Du</em>

[3] <strong>DINOv2: Learning Robust Visual Features without Supervision,2024</strong> | [Paper](arxiv.org/abs/2304.07193) | [Github](github.com/facebookresearch/dinov2)
<br><em>&ensp; &ensp; &ensp;Maxime Oquab<sup>&#8727;</sup>, TimothÃ©e Darcet, ThÃ©o Moutakanni, Huy Vo, Marc Szafraniec, Vasil Khalidov, Pierre Fernandez, Daniel Haziza, Francisco Massa, Alaaeldin El-Nouby, Mahmoud Assran, Nicolas Ballas, Wojciech Galuba, Russell Howes, Po-Yao Huang, Shang-Wen Li, Ishan Misra, Michael Rabbat, Vasu Sharma, Gabriel Synnaeve, Hu Xu, HervÃ© Jegou, Julien Mairal, Patrick Labatut, Armand Joulin and Piotr Bojanowski</em>
